!function(e,t,n,a){var r=function(t,n){this.elem=t,this.$elem=e(t),this.options=n,this.tags=[]};r.prototype={keys:{add:{comma:188,enter:13,spacebar:32},remove:{del:46,backspace:8}},defaults:{"case-sensitive":!1,"close-char":"&times;","close-class":"tag-i","edit-on-delete":!0,"forbidden-chars":[".","_","?"],"forbidden-chars-callback":t.alert,"forbidden-chars-text":"Forbidden character:","forbidden-words":[],"forbidden-words-callback":t.alert,"forbidden-words-text":"Forbidden word:","no-backspace":!1,"no-comma":!1,"no-del":!1,"no-duplicate":!0,"no-duplicate-callback":t.alert,"no-duplicate-text":"Duplicate tag:","no-enter":!1,"no-spacebar":!1,"pre-tags-separator":", ","tag-box-class":"tagging","tag-box-editable-class":"editable","tag-char":"#","tag-class":"tag","tags-input-name":"tag","tag-on-blur":!0,"tags-limit":0,"type-zone-class":"type-zone"},add:function(t){var a,r,i,o,s;if(i=this,e.isArray(t))return e.each(t,function(){i.add(this+"")});if(s=i.config["forbidden-words"],t||(t=i.valInput(),i.emptyInput()),!t||!t.length)return!1;for(i.config["case-sensitive"]||(t=t.toLowerCase()),r=s.length;r--;)if(0<=(o=t.indexOf(s[r])))return i.emptyInput(),r=i.config["forbidden-words-callback"],o=i.config["forbidden-words-text"],i.throwError(r,o,t);if(i.config["no-duplicate"])for(r=i.tags.length;r--;)if(i.tags[r].pure_text===t)return i.emptyInput(),r=i.config["no-duplicate-callback"],o=i.config["no-duplicate-text"],i.throwError(r,o,t);return a=e(n.createElement("div")).addClass(i.config["tag-class"]).html("<span>"+i.config["tag-char"]+"</span> "+t),e(n.createElement("input")).attr("type","hidden").attr("name",i.config["tags-input-name"]+"[]").val(t).appendTo(a),e(n.createElement("a")).attr("role","button").addClass(i.config["close-class"]).html(i.config["close-char"]).click(function(){i.remove(a)}).appendTo(a),a.pure_text=t,i.tags.push(a),i.$type_zone.before(a),0<i.config["tags-limit"]&&i.tags.length>=i.config["tags-limit"]&&(i.$elem.removeClass(i.config["tag-box-editable-class"]),i.$type_zone.hide()),i.$elem.trigger("add:after",[t,i]),!0},addSpecialKeys:function(t){var n,a,r,i;if(n=this,i=t[0],r=t[1],t={},e.isArray(r))return e.each(r,function(){n.addSpecialKeys([i,this])});if(!r&&r.constructor!==Object)return"Error -> The second argument is not an Object!";for(a in r)r.hasOwnProperty(a)&&r[a]===+r[a]&&r[a]===(0|r[a])&&e.extend(t,r);return n.keys[i]=e.extend({},t,n.keys[i]),n.keys[i]},destroy:function(){return this.$elem.find("."+this.config["type-zone-class"]).remove(),this.$elem.find("."+this.config["tag-class"]).remove(),this.$elem.data("tag-box",null),!0},emptyInput:function(){return this.focusInput(),this.valInput("")},focusInput:function(){return this.$type_zone.focus()},getDataOptions:function(){var e,t,n;for(e in n={},this.defaults)(t=this.$elem.data(e))&&(n[e]=t);return n},getSpecialKeys:function(){return e.extend({},this.keys.add,this.keys.remove)},getSpecialKeysD:function(){return this.keys},getTags:function(){var e,t,n;for(n=this.tags.length,e=[],t=0;t<n;t+=1)e.push(this.tags[t].pure_text);return e},getTagsObj:function(){return this.tags},init:function(){var t,a,r;return(a=this).config=e.extend({},a.defaults,a.options,a.getDataOptions()),t=a.$elem.text(),a.$elem.empty(),a.$type_zone=e(n.createElement("input")).addClass(a.config["type-zone-class"]).attr("contenteditable",!0),a.$elem.addClass(a.config["tag-box-class"]).addClass(a.config["tag-box-editable-class"]).append(a.$type_zone),a.$type_zone.keydown(function(e){var t,n,r,i,o;if(n=a.getSpecialKeys(),i=a.config["forbidden-chars"],o=a.valInput(),r=e.which,o){for(n=i.length;n--;)if(0<=o.indexOf(i[n]))return e.preventDefault(),o=o.replace(i[n],""),a.focusInput(),a.valInput(o),e=a.config["forbidden-chars-callback"],t=a.config["forbidden-chars-text"],a.throwError(e,t,i[n]);for(t in a.keys.add)if(r===a.keys.add[t]&&!a.config["no-"+t])return e.preventDefault(),a.add()}else for(t in n)if(r===n[t]){if(a.keys.add[t]){e.preventDefault();break}if(a.keys.remove[t]&&!a.config["no-"+t])return e.preventDefault(),a.remove()}return!0}),a.config["tag-on-blur"]&&a.$type_zone.focusout(function(){return!(!(r=a.valInput())||!r.length)&&a.add()}),a.$elem.on("click",function(){a.focusInput()}),a.refresh(t),a},refresh:function(t){var n,a;return a=(n=this).config["pre-tags-separator"],t=t||n.getTags().join(a),n.reset(),e.each(t.split(a),function(){n.add(this+"")}),!0},remove:function(t){var n,a,r;if(n=this,e.isArray(t))return e.each(t,function(){n.remove(this+"")});if("string"==typeof t&&(a=t,!(t=n.$elem.find("input[value="+a+"]").parent()).length))return"Error -> Tag not found";if(t)for(r=n.tags.length;r--;)n.tags[r][0].innerHTML===t[0].innerHTML&&n.tags.splice(r,1);else t=n.tags.pop();return a=a||t.pure_text,t.remove(),n.config["edit-on-delete"]&&(n.emptyInput(),n.valInput(t.pure_text)),0<n.config["tags-limit"]&&n.$type_zone.not(":visible")&&n.tags.length<n.config["tags-limit"]&&(n.$elem.addClass(n.config["tag-box-editable-class"]),n.$type_zone.show()),n.$elem.trigger("remove:after",[a,n]),t},removeAll:function(){return this.reset()},removeSpecialKeys:function(t){var n,a,r;if(n=this,r=t[0],t=t[1],e.isArray(t))return e.each(t,function(){n.removeSpecialKeys([r,this])});for(a in n.keys[r])n.keys[r].hasOwnProperty(a)&&n.keys[r][a]===t&&(n.keys[r][a]=void 0);return n.keys[r]},reset:function(){for(;this.tags.length;)this.remove(this.tags[this.tags.length]);return this.emptyInput(),this.tags},throwError:function(e,t,n){return e([t+" '"+n+"'."])},valInput:function(e){return null==e?this.$type_zone.val():this.$type_zone.val(e)}},e.fn.tagging=function(t,n){var a=[];return this.each(function(){var i,o;(o=(i=e(this)).data("tag-box"))?(i=o[t](n))&&a.push(i):(o=new r(this,t),i.data("tag-box",o),o.init(),a.push(o.$elem))}),"string"==typeof t?1<a.length?a:a[0]:a}}(window.jQuery,window,document);